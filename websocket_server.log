2025-04-05 15:51:19,407 - WebSocketServer - ERROR - 导入情绪识别模块失败: No module named 'dbmodule'
2025-04-05 15:51:19,407 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 27, in <module>
    from emotion_recognition.emotions.inmidinate_output import app, process_frame, load_target_feats_from_db, StatusLogger, DataCollector
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\emotion_recognition\emotions\inmidinate_output.py", line 2, in <module>
    from dbmodule import *
ModuleNotFoundError: No module named 'dbmodule'

2025-04-05 15:58:39,407 - WebSocketServer - ERROR - 导入情绪识别模块失败: No module named 'zwky_api.emotion_recognition'
2025-04-05 15:58:39,408 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 32, in <module>
    from zwky_api.emotion_recognition.emotions.inmidinate_output import app, process_frame, load_target_feats_from_db, StatusLogger, DataCollector
ModuleNotFoundError: No module named 'zwky_api.emotion_recognition'

2025-04-05 15:59:26,088 - WebSocketServer - INFO - 成功导入情绪识别模块
2025-04-05 15:59:26,092 - WebSocketServer - INFO - 成功加载 7 个人脸特征向量
2025-04-05 15:59:26,113 - websockets.server - INFO - server listening on 0.0.0.0:8765
2025-04-05 15:59:26,113 - WebSocketServer - INFO - WebSocket服务器启动在 ws://0.0.0.0:8765
2025-04-05 15:59:34,092 - websockets.server - INFO - connection open
2025-04-05 15:59:34,092 - websockets.server - ERROR - connection handler failed
Traceback (most recent call last):
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\server.py", line 376, in conn_handler
    await self.handler(connection)
          ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_client() missing 1 required positional argument: 'path'
2025-04-05 15:59:39,404 - websockets.server - INFO - connection open
2025-04-05 15:59:39,404 - websockets.server - ERROR - connection handler failed
Traceback (most recent call last):
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\server.py", line 376, in conn_handler
    await self.handler(connection)
          ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_client() missing 1 required positional argument: 'path'
2025-04-05 15:59:44,715 - websockets.server - INFO - connection open
2025-04-05 15:59:44,717 - websockets.server - ERROR - connection handler failed
Traceback (most recent call last):
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\server.py", line 376, in conn_handler
    await self.handler(connection)
          ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_client() missing 1 required positional argument: 'path'
2025-04-05 16:00:16,687 - websockets.server - INFO - server closing
2025-04-05 16:00:16,687 - websockets.server - INFO - server closed
2025-04-05 16:00:16,687 - WebSocketServer - INFO - 服务器已关闭，所有连接已清理
2025-04-05 16:00:16,688 - WebSocketServer - INFO - 服务器被用户中断
2025-04-12 19:41:36,158 - WebSocketServer - WARNING - 未检测到支持CUDA的设备，将使用CPU模式
2025-04-12 19:41:43,152 - WebSocketServer - INFO - 成功导入情绪识别模块
2025-04-12 19:41:43,153 - WebSocketServer - INFO - 尝试从以下路径加载数据库: F:\AAB\AAAzwky - 副本 (2)\zwky_api\db.sqlite3
2025-04-12 19:41:43,160 - WebSocketServer - INFO - 成功加载 8 个人脸特征向量
2025-04-12 19:41:43,177 - WebSocketServer - INFO - 已将进程优先级设置为高
2025-04-12 19:41:43,181 - WebSocketServer - INFO - 未安装uvloop，使用默认事件循环
2025-04-12 19:41:43,183 - WebSocketServer - INFO - 正在启动WebSocket服务器 ws://0.0.0.0:8765...
2025-04-12 19:41:43,215 - websockets.server - INFO - server listening on 0.0.0.0:8765
2025-04-12 19:41:43,215 - WebSocketServer - INFO - WebSocket服务器启动成功，监听在 ws://0.0.0.0:8765
2025-04-12 19:41:53,381 - websockets.server - INFO - connection open
2025-04-12 19:41:53,381 - WebSocketServer - INFO - 新客户端连接 [ID: 2772483144592]
2025-04-12 19:41:55,269 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 19:41:55,273 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 19:41:55,277 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772483144592]
2025-04-12 19:41:55,277 - WebSocketServer - INFO - 清理完成 [ID: 2772483144592]
2025-04-12 20:20:00,632 - websockets.server - INFO - connection open
2025-04-12 20:20:00,632 - WebSocketServer - INFO - 新客户端连接 [ID: 2774379114960]
2025-04-12 20:20:19,273 - websockets.server - INFO - connection open
2025-04-12 20:20:19,274 - WebSocketServer - INFO - 新客户端连接 [ID: 2772484476112]
2025-04-12 20:20:43,218 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:20:43,218 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:20:43,218 - WebSocketServer - INFO - 客户端断开连接 [ID: 2774379114960]
2025-04-12 20:20:43,218 - WebSocketServer - INFO - 清理完成 [ID: 2774379114960]
2025-04-12 20:20:46,448 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:20:46,448 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:20:46,466 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772484476112]
2025-04-12 20:20:46,466 - WebSocketServer - INFO - 清理完成 [ID: 2772484476112]
2025-04-12 20:20:53,465 - websockets.server - INFO - connection open
2025-04-12 20:20:53,465 - WebSocketServer - INFO - 新客户端连接 [ID: 2774379102288]
2025-04-12 20:21:15,602 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\server.py", line 356, in conn_handler
    await connection.handshake(
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\server.py", line 142, in handshake
    async with self.send_context(expected_state=CONNECTING):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedError: no close frame received or sent
2025-04-12 20:21:22,281 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:21:22,281 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:21:22,281 - WebSocketServer - INFO - 客户端断开连接 [ID: 2774379102288]
2025-04-12 20:21:22,281 - WebSocketServer - INFO - 清理完成 [ID: 2774379102288]
2025-04-12 20:37:01,009 - websockets.server - INFO - connection open
2025-04-12 20:37:01,009 - WebSocketServer - INFO - 新客户端连接 [ID: 2772483689040]
2025-04-12 20:37:19,480 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:37:19,480 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:37:19,480 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772483689040]
2025-04-12 20:37:19,480 - WebSocketServer - INFO - 清理完成 [ID: 2772483689040]
2025-04-12 20:37:45,988 - websockets.server - INFO - connection open
2025-04-12 20:37:45,988 - WebSocketServer - INFO - 新客户端连接 [ID: 2774375303888]
2025-04-12 20:37:46,145 - WebSocketServer - INFO - 清理完成 [ID: 2774375303888]
2025-04-12 20:38:49,763 - websockets.server - INFO - connection open
2025-04-12 20:38:49,763 - WebSocketServer - INFO - 新客户端连接 [ID: 2774379088976]
2025-04-12 20:38:52,384 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:38:52,388 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:38:52,388 - WebSocketServer - INFO - 客户端断开连接 [ID: 2774379088976]
2025-04-12 20:38:52,388 - WebSocketServer - INFO - 清理完成 [ID: 2774379088976]
2025-04-12 20:38:54,518 - websockets.server - INFO - connection open
2025-04-12 20:38:54,519 - WebSocketServer - INFO - 新客户端连接 [ID: 2772484319184]
2025-04-12 20:38:58,821 - websockets.server - INFO - connection open
2025-04-12 20:38:58,821 - WebSocketServer - INFO - 新客户端连接 [ID: 2772484481552]
2025-04-12 20:38:59,965 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:38:59,967 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:38:59,968 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772484481552]
2025-04-12 20:38:59,968 - WebSocketServer - INFO - 清理完成 [ID: 2772484481552]
2025-04-12 20:41:25,437 - websockets.server - INFO - connection open
2025-04-12 20:41:25,437 - WebSocketServer - INFO - 新客户端连接 [ID: 2772485063056]
2025-04-12 20:41:26,828 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:41:26,828 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:41:26,828 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772485063056]
2025-04-12 20:41:26,828 - WebSocketServer - INFO - 清理完成 [ID: 2772485063056]
2025-04-12 20:41:44,708 - websockets.server - INFO - connection open
2025-04-12 20:41:44,708 - WebSocketServer - INFO - 新客户端连接 [ID: 2774379088976]
2025-04-12 20:41:45,237 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:41:45,237 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:41:45,250 - WebSocketServer - INFO - 客户端断开连接 [ID: 2774379088976]
2025-04-12 20:41:45,250 - WebSocketServer - INFO - 清理完成 [ID: 2774379088976]
2025-04-12 20:42:16,912 - websockets.server - INFO - connection open
2025-04-12 20:42:16,912 - WebSocketServer - INFO - 新客户端连接 [ID: 2772484926736]
2025-04-12 20:42:26,520 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:42:26,520 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:42:26,520 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772484926736]
2025-04-12 20:42:26,520 - WebSocketServer - INFO - 清理完成 [ID: 2772484926736]
2025-04-12 20:42:28,825 - websockets.server - INFO - connection open
2025-04-12 20:42:28,825 - WebSocketServer - INFO - 新客户端连接 [ID: 2774367452624]
2025-04-12 20:42:32,243 - websockets.server - INFO - connection open
2025-04-12 20:42:32,243 - WebSocketServer - INFO - 新客户端连接 [ID: 2772485073360]
2025-04-12 20:42:36,749 - WebSocketServer - ERROR - 处理消息时发生错误: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-04-12 20:42:36,749 - WebSocketServer - ERROR - Traceback (most recent call last):
  File "F:\AAB\AAAzwky - 副本 (2)\zwky_api\websocket_server.py", line 264, in handle_client
    await websocket.send(json.dumps(result))
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 476, in send
    async with self.send_context():
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "F:\AAB\AAAzwky\venv\Lib\site-packages\websockets\asyncio\connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2025-04-12 20:42:36,749 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772485073360]
2025-04-12 20:42:36,749 - WebSocketServer - INFO - 清理完成 [ID: 2772485073360]
2025-04-12 20:43:34,411 - websockets.server - INFO - connection open
2025-04-12 20:43:34,411 - WebSocketServer - INFO - 新客户端连接 [ID: 2772484486864]
2025-04-12 20:43:35,163 - WebSocketServer - INFO - 清理完成 [ID: 2772484486864]
2025-04-12 20:46:18,101 - WebSocketServer - INFO - 客户端断开连接 [ID: 2774367452624]
2025-04-12 20:46:18,102 - WebSocketServer - INFO - 清理完成 [ID: 2774367452624]
2025-04-12 20:46:18,103 - WebSocketServer - INFO - 客户端断开连接 [ID: 2772484319184]
2025-04-12 20:46:18,103 - WebSocketServer - INFO - 清理完成 [ID: 2772484319184]
